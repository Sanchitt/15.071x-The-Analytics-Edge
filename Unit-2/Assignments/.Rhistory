setwd("~/Development/learning/edx/15.071x-The-Analytics-Edge/Unit-2")
wine = read.csv("wine.csv")
str(wine)
summary(wine)
str(wine)
model1 = lm(Price ~ AGST)
model1 = lm(Price ~ AGST, data = wine)
str(model1)
summary(model1)
SSE = sum(model1$residuals ^ 2)
model1 = lm(Price ~ AGST + HarvestRain, data = wine)
model2 = lm(Price ~ AGST + HarvestRain, data = wine)
SSE = sum(model2$residuals ^ 2)
View(wine)
model3 = lm(Price ~ AGST + HarvestRain + WinterRain + Age + FrancePop, data = wine)
SSE = sum(model3$residuals ^ 2)
model4 = lm(Price ~ HarvestRain + WinterRain, data = wine)
summary(model4)
cor(wine$HarvestRain, wine$WinterRain)
cor(wine)
plot(wine$AGST, wine$Price)
source('~/Development/learning/edx/15.071x-The-Analytics-Edge/Unit-2/LinearRegressionWine.R')
source('~/Development/learning/edx/15.071x-The-Analytics-Edge/Unit-2/LinearRegressionWine.R')
baseball = read.csv("baseball.csv")
moneyball = subset(baseball, Year < 2002)
summary(moneyball)
baseball$RD = baseball$RS - baseball$RA
moneyball = subset(baseball, Year < 2002)
WinReg = lm(W ~ RD, data = moneyball)
summary(WinReg)
plot(baseball$RD, baseball$W)
data.frame("RD" = 713-614)
predict(WinReg, newdata = data.frame("RD" = 713-614))
RSReg = lm(RS ~ OBP + SLG, data = moneyball)
summary(RSReg)
-804.63 + 2737.77 * 0.311 + 1584.91 * 0.405
RAReg = lm(RA ~ OOBP + OSLG, data = moneyball)
RAReg = lm(RA ~ OOBP + OSLG, data = moneyball)
summary(RSReg)
summary(RAReg)
-837.38 + 2913.60 * 0.297 + 1514.29 * 0.370
qq = read.csv("QuickQuestion.csv")
summary(qq)
qqPredict = predict(RSReg, newdata = qq)
summary(qqPredict)
str(qqPredict)
View(qq)
predict(RSReg, newdata = qq)
teamRank = c(1,2,3,3,4,4,4,4,5,5)
wins2012 = c(94,88,95,88,93,94,98,97,93,94)
wins2013 = c(97,97,92,93,92,96,94,96,92,90)
cor(teamRank, wins2012)
cor(teamRank, wins2013)
setwd("~/Development/learning/edx/15.071x-The-Analytics-Edge/Unit-2/Assignments")
climate_change <- read.csv("~/Development/learning/edx/15.071x-The-Analytics-Edge/Unit-2/Assignments/climate_change.csv", header=FALSE)
View(climate_change)
climate = read.csv("climate_change.csv")
climate_train = subset(climate, YEAR <= 2006)
climate_train = subset(climate, Year <= 2006)
climate_test = subset(climate, Year > 2006)
climateReg1 = lm(Temp ~ MEI + CO2 + CH4 + N20 + CFC.11 + CFC.12 + TSI, data = climate_train)
climateReg1 = lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + TSI, data = climate_train)
summary(climateReg1)
climateReg1 = lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + TSI + Aerosols, data = climate_train)
summary(climateReg1)
cor(climate$CFC.11, climate$N2O)
cor(climate)
climateReg2 = lm(Temp ~ MEI + N2O + TSI + Aerosols, data = climate_train)
summary(climateReg2)
step(climateReg1)
climateReg3 = lm(formula = Temp ~ MEI + CO2 + N2O + CFC.11 + CFC.12 + TSI +
Aerosols, data = climate_train)
climateReg3 = lm(formula = Temp ~ MEI + CO2 + N2O + CFC.11 + CFC.12 + TSI + Aerosols, data = climate_train)
summary(climateReg3)
tempPredictions = predict(climateReg3, newdata = climate_test)
SSE = sum((tempPredictions - climate_test) ^ 2)
SSt = sum((mean(climate_test$Temp) - climate_test) ^ 2)
SST = sum((mean(climate_test$Temp) - climate_test) ^ 2)
1 - SSE/SST
SSE = sum((climate_test$Temp - tempPredictions) ^ 2)
tempPredictions = predict(climateReg3, newdata = climate_test)
tempPredictions
SST = sum((climate_test$Temp - mean(tempPredictions)) ^ 2)
1 - SSE/SST
SST = sum((climate_test$Temp - mean(climate_train$Temp)) ^ 2)
1 - SSE/SST
pisa_train = read.csv("pisa2009train.csv")
pisa_test = read.csv("pisa2009test.csv")
("pisa2009train.csv")
pisaTest = read.csv("pisa200
)
)
""
)
)
q
pisaTrain = read.csv("pisa2009train.csv")
pisaTest = read.csv("pisa2009test.csv")
table(pisaTrain$readingScore, pisaTrain$male)
tapply(pisaTrain$readingScore, pisaTrain$male, mean)
str(pisaTrain)
summary(pisaTrain)
pisaTrain = na.omit(pisaTrain)
pisaTest = na.omit(pisaTest)
pisaTrain$raceeth = relevel(pisaTrain$raceeth, "White")
pisaTest$raceeth = relevel(pisaTest$raceeth, "White")
lmScore = lm(ReadingScore ~ ., data = pisaTrain)
lmScore = lm(readingScore ~ ., data = pisaTrain)
summary(lmScore)
SSE = sum(lmScore$residuals ^ 2)
RMSE = sqrt(SSE/nrow(pisaTrain))
RMSE
mean(pisaTrain$readingScore)
2e-16 * 9 - 2e-16 * 11
summary(lmScore)
29.542707 * 9 - 29.542707 * 11
predTest = predict(lmScore, newdata = pisaTest)
predTest
range(predTest)
353.2231 - 637.6914
SSE = sum((pisaTest$readingScore - predTest) ^ 2)
SSE
RMSE = sqrt(SSE/nrow(predTest))
RMSE
RMSE = sqrt(SSE/nrow(pisaTest))
RMSE = sqrt(SSE/nrows(pisaTest))
RMSE = sqrt(SSE/nrow(pisaTest))
RMSE
mean(pisaTrain$readingScore)
SST = sum((pisaTest$readingScore - mean(pisaTrain$readingScore)) ^ 2)
SST
1 - SSE/SST
fluTrain = read.csv("FluTrain.csv")
plot(fluTrain$Week, fluTrain$ILI)
sort(table(fluTrain$Week, fluTrain$ILI))
head(table(fluTrain$Week, fluTrain$ILI))
rev(sort(table(fluTrain$Week, fluTrain$ILI)))
head(rev(sort(table(fluTrain$Week, fluTrain$ILI))))
tapply(fluTrain$ILI, fluTrain$Week, sum)
max(tapply(fluTrain$ILI, fluTrain$Week, sum))
sort(tapply(fluTrain$ILI, fluTrain$Week, sum))
sort(tapply(fluTrain$Queries, fluTrain$Week, sum))
subset(FluTrain, Queries == max(Queries))
subset(fluTrain, Queries == max(Queries))
hist(fluTrain$ILI)
plot(log(fluTrain$ILI), fluTrain$Queries)
fluTrend1 = lm(log(ILI) ~ Queries, data = fluTrain)
summary(fluTrend1)
cor(fluTrain$ILI, fluTrain$Queries)
corvalue = cor(fluTrain$ILI, fluTrain$Queries)
log(1/corvalue)
exp(-0.5*corvalue)
corvalue^2
fluTest = read.csv("FluTest.csv")
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
PredTest1 = exp(predict(fluTrend1, newdata=fluTest))
which?
?which
PredTest1
View(fluTest)
which(fluTest)
which(fluTest, Week == "2012-03-11 - 2012-03-17")
which(fluTest$Week == "2012-03-11 - 2012-03-17")
fluTest$ILI[11] - 2.187378
(fluTest$ILI[11] - 2.187378)/fluTest$ILI[11]
SSE = sum((fluTest$ILI - PredTest1) ^ )
SSE = sum((fluTest$ILI - PredTest1) ^ 2)
RMSE = sqrt(SSE/nrow(fluTest))
RMSE
install.packages("zoo")
library(zoo)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
ILILag2 = lag(zoo(fluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
fluTrain$ILILag2 = coredata(ILILag2)
summary(ILILag2)
plot(log(fluTrain$ILILag2), fluTrain$ILI)
fluTrend2 = lm(ILI ~ Queries + ILILag2, data = fluTrain)
summary(fluTrend2)
fluTrend2 = lm(log(ILI) ~ Queries + ILILag2, data = fluTrain)
summary(fluTrend2)
fluTrend2 = lm(log(ILI) ~ Queries + ILILag2, data = fluTrain)
summary(fluTrend2)
ILILag2Test = lag(zoo(fluTest$ILI), -2, na.pad = TRUE)
fluTest$ILILag2 = coredata(ILILag2Test)
summary(fluTest)
tail(fluTrain$ILI)
ILILag2 = lag(zoo(fluTrain$ILI), -2, na.pad=TRUE)
fluTrain$ILILag2 = coredata(ILILag2)
summary(ILILag2)
fluTrend2 = lm(log(ILI) ~ Queries + ILILag2, data = fluTrain)
summary(fluTrend2)
View(fluTrain)
PredTest2 = exp(predict(fluTrend2, newdata = fluTest))
RMSE = sqrt(mean((fluTest$ILI - PredTest2) ^ @))
RMSE = sqrt(mean((fluTest$ILI - PredTest2) ^ 2))
SSE = sum((fluTest$ILI - PredTest2))
PredTest2
fluTest[1] = fluTrain$ILI[-1]
fluTest[1] = fluTrain$ILI[nrow(fluTrain) - 1]
fluTest[2] = fluTrain$ILI[nrow(fluTrain)]
PredTest2 = exp(predict(fluTrend2, newdata = fluTest))
RMSE = sqrt(mean((fluTest$ILI - PredTest2) ^ 2))
PredTest2
fluTest
fluTest = read.csv("FluTest.csv")
ILILag2Test = lag(zoo(fluTest$ILI), -2, na.pad = TRUE)
fluTest$ILILag2 = coredata(ILILag2Test)
fluTest$ILILag2[1] = fluTrain$ILI[nrow(fluTrain) - 1]
fluTest$ILILag2[2] = fluTrain$ILI[nrow(fluTrain)]
fluTest
PredTest2 = exp(predict(fluTrend2, newdata = fluTest))
RMSE = sqrt(mean((fluTest$ILI - PredTest2) ^ 2))
SSE = sum((fluTest$ILI - PredTest2))
RMSE = sqrt(SSE/nrow(fluTest))
PredTest2
SSE = sum((fluTest$ILI - PredTest2))
RMSE = sqrt(SSE/nrow(fluTest))
nrow(fluTest)
SSE
SSE = sum((fluTest$ILI - PredTest2)^2)
RMSE = sqrt(SSE/nrow(fluTest))
RMSE
library("zoo")
train = read.csv("FluTrain.csv")
ILILag = lag(zoo(train$ILI), -2, na.pad = TRUE)
train$ILILag = coredata(ILILag)
model = lm(log(ILI) ~ Queries + ILILag, data = train)
summary(model)
model = lm(log(ILI) ~ Queries + log(ILILag), data = train)
summary(model)
fluTrain = read.csv("FluTrain.csv")
sort(tapply(fluTrain$ILI, fluTrain$Week, sum))
sort(tapply(fluTrain$Queries, fluTrain$Week, sum))
subset(fluTrain, Queries == max(Queries))
hist(fluTrain$ILI)
plot(log(fluTrain$ILI), fluTrain$Queries)
fluTrend1 = lm(log(ILI) ~ Queries, data = fluTrain)
summary(fluTrend1)
corvalue = cor(fluTrain$ILI, fluTrain$Queries)
corvalue^2
fluTest = read.csv("FluTest.csv")
PredTest1 = exp(predict(fluTrend1, newdata=fluTest))
which(fluTest$Week == "2012-03-11 - 2012-03-17")
(fluTest$ILI[11] - 2.187378)/fluTest$ILI[11]
SSE = sum((fluTest$ILI - PredTest1) ^ 2)
RMSE = sqrt(SSE/nrow(fluTest))
library(zoo)
ILILag2 = lag(zoo(fluTrain$ILI), -2, na.pad=TRUE)
fluTrain$ILILag2 = coredata(ILILag2)
summary(ILILag2)
plot(log(fluTrain$ILILag2), fluTrain$ILI)
fluTrend2 = lm(log(ILI) ~ Queries + log(ILILag2), data = fluTrain)
summary(fluTrend2)
ILILag2Test = lag(zoo(fluTest$ILI), -2, na.pad = TRUE)
fluTest$ILILag2 = coredata(ILILag2Test)
summary(fluTest)
tail(fluTrain$ILI)
fluTest$ILILag2[1] = fluTrain$ILI[nrow(fluTrain) - 1]
fluTest$ILILag2[2] = fluTrain$ILI[nrow(fluTrain)]
fluTrend2 = lm(log(ILI) ~ Queries + log(ILILag2), data = fluTrain)
PredTest2 = exp(predict(fluTrend2, newdata = fluTest))
RMSE = sqrt(mean((fluTest$ILI - PredTest2) ^ 2))
SSE = sum((fluTest$ILI - PredTest2)^2)
RMSE
